{"version":3,"file":"tags.js","sources":["../../tools/sidekick/plugins/tags/tags.ts"],"sourcesContent":["/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n\n */\n// @ts-ignore import module\nimport { PLUGIN_EVENTS } from 'https://main--franklin-library-host--dylandepass.hlx.live/tools/sidekick/library/events/events.js';\n\nconst selectedTags: string[] = [];\n\nfunction getSelectedLabel(): string {\n  return selectedTags.length > 0\n    ? `${selectedTags.length} tag${selectedTags.length > 1 ? 's' : ''} selected`\n    : 'No tags selected';\n}\n\ninterface TagItem {\n  tag: string;\n}\n\nfunction getFilteredTags(data: TagItem[], query: string): TagItem[] {\n  if (!query) {\n    return data;\n  }\n\n  return data.filter((item) => item.tag.toLowerCase().includes(query.toLowerCase()));\n}\n\nexport async function decorate(container: HTMLElement, data: TagItem[], query: string): Promise<void> {\n  const createMenuItems = (): string => {\n    const filteredTags = getFilteredTags(data, query);\n    return filteredTags\n      .map((item) => {\n        const isSelected = selectedTags.includes(item.tag);\n        return `\n        <sp-menu-item value=\"${item.tag}\" ${isSelected ? 'selected' : ''}>\n          ${item.tag}\n        </sp-menu-item>\n      `;\n      })\n      .join('');\n  };\n\n  const handleMenuItemClick = (e: Event): void => {\n    const target = e.target as HTMLOptionElement;\n    const { value, selected } = target;\n\n    if (selected) {\n      const index = selectedTags.indexOf(value);\n      if (index > -1) {\n        selectedTags.splice(index, 1);\n      }\n    } else {\n      selectedTags.push(value);\n    }\n\n    const selectedLabel = container.querySelector('.selectedLabel');\n    if (selectedLabel) {\n      selectedLabel.textContent = getSelectedLabel();\n    }\n  };\n\n  const handleCopyButtonClick = (): void => {\n    navigator.clipboard.writeText(selectedTags.join(', '));\n    container.dispatchEvent(\n      new CustomEvent(PLUGIN_EVENTS.TOAST, {\n        detail: { message: 'Copied Tags' },\n      })\n    );\n  };\n\n  const menuItems = createMenuItems();\n  const sp = `\n    <sp-menu\n      label=\"Select tags\"\n      selects=\"multiple\"\n      data-testid=\"taxonomy\"\n    >\n      ${menuItems}\n    </sp-menu>\n    <sp-divider size=\"s\"></sp-divider>\n    <div class=\"footer\">\n      <span class=\"selectedLabel\">${getSelectedLabel()}</span>\n      <sp-action-button label=\"Copy\" quiet>\n        <sp-icon-copy slot=\"icon\"></sp-icon-copy>\n      </sp-action-button>\n    </div>\n  `;\n\n  const spContainer = document.createElement('div');\n  spContainer.classList.add('container');\n  spContainer.innerHTML = sp;\n  container.append(spContainer);\n\n  const menuItemElements = spContainer.querySelectorAll('sp-menu-item');\n  menuItemElements.forEach((item) => {\n    item.addEventListener('click', handleMenuItemClick);\n  });\n\n  const copyButton = spContainer.querySelector('sp-action-button');\n  if (copyButton) {\n    copyButton.addEventListener('click', handleCopyButtonClick);\n  }\n}\n\nexport default {\n  title: 'Tags',\n  searchEnabled: true,\n};\n\n"],"names":["selectedTags","getSelectedLabel","getFilteredTags","data","query","item","decorate","container","createMenuItems","isSelected","handleMenuItemClick","e","target","value","selected","index","selectedLabel","handleCopyButtonClick","PLUGIN_EVENTS","sp","spContainer","copyButton","tags"],"mappings":"kIAeA,MAAMA,EAAyB,CAAA,EAE/B,SAASC,GAA2B,CAClC,OAAOD,EAAa,OAAS,EACzB,GAAGA,EAAa,MAAM,OAAOA,EAAa,OAAS,EAAI,IAAM,EAAE,YAC/D,kBACN,CAMA,SAASE,EAAgBC,EAAiBC,EAA0B,CAClE,OAAKA,EAIED,EAAK,OAAQE,GAASA,EAAK,IAAI,YAAY,EAAE,SAASD,EAAM,YAAY,CAAC,CAAC,EAHxED,CAIX,CAEsB,eAAAG,EAASC,EAAwBJ,EAAiBC,EAA8B,CACpG,MAAMI,EAAkB,IACDN,EAAgBC,EAAMC,CAAK,EAE7C,IAAKC,GAAS,CACb,MAAMI,EAAaT,EAAa,SAASK,EAAK,GAAG,EAC1C,MAAA;AAAA,+BACgBA,EAAK,GAAG,KAAKI,EAAa,WAAa,EAAE;AAAA,YAC5DJ,EAAK,GAAG;AAAA;AAAA,OAAA,CAGb,EACA,KAAK,EAAE,EAGNK,EAAuBC,GAAmB,CAC9C,MAAMC,EAASD,EAAE,OACX,CAAE,MAAAE,EAAO,SAAAC,CAAa,EAAAF,EAE5B,GAAIE,EAAU,CACN,MAAAC,EAAQf,EAAa,QAAQa,CAAK,EACpCE,EAAQ,IACGf,EAAA,OAAOe,EAAO,CAAC,CAC9B,MAEAf,EAAa,KAAKa,CAAK,EAGnB,MAAAG,EAAgBT,EAAU,cAAc,gBAAgB,EAC1DS,IACFA,EAAc,YAAcf,IAC9B,EAGIgB,EAAwB,IAAY,CACxC,UAAU,UAAU,UAAUjB,EAAa,KAAK,IAAI,CAAC,EAC3CO,EAAA,cACR,IAAI,YAAYW,EAAc,MAAO,CACnC,OAAQ,CAAE,QAAS,aAAc,CAAA,CAClC,CAAA,CACH,EAIIC,EAAK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADOX,GAOH;AAAA;AAAA;AAAA;AAAA,oCAImBP,GAAkB;AAAA;AAAA;AAAA;AAAA;AAAA,IAO9CmB,EAAc,SAAS,cAAc,KAAK,EACpCA,EAAA,UAAU,IAAI,WAAW,EACrCA,EAAY,UAAYD,EACxBZ,EAAU,OAAOa,CAAW,EAEHA,EAAY,iBAAiB,cAAc,EACnD,QAASf,GAAS,CAC5BA,EAAA,iBAAiB,QAASK,CAAmB,CAAA,CACnD,EAEK,MAAAW,EAAaD,EAAY,cAAc,kBAAkB,EAC3DC,GACSA,EAAA,iBAAiB,QAASJ,CAAqB,CAE9D,CAEA,MAAeK,EAAA,CACb,MAAO,OACP,cAAe,EACjB"}